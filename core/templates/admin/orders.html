{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<h1>Pedidos Recebidos - Filial Austin</h1>

{% if messages %}
  {% for message in messages %}
    <p style="color: green;">{{ message }}</p>
  {% endfor %}
{% endif %}

{% if orders %}
  {% for order in orders %}
    <div style="
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    ">
      <h3>Pedido #{{ order.id }}</h3>

      <p>
        <strong>Origem:</strong> {{ order.origin_location.name }}<br>
        <strong>Status:</strong> {{ order.get_status_display }}<br>
        <strong>Criado em:</strong> {{ order.created_at|date:"d/m/Y H:i" }}
      </p>

      <h4>Itens do pedido</h4>
      <ul>
        {% for item in order.items.all %}
          <li>
            {{ item.product.name }} —
            Quantidade: {{ item.quantity }}
          </li>
        {% endfor %}
      </ul>

      <div style="margin-top: 15px;">
        <!-- BOTÃO ENVIADO -->
        <form method="post" action="{% url 'conclude_order' order.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit"
            style="
              background-color: #198754;
              color: white;
              border: none;
              padding: 8px 12px;
              cursor: pointer;
              border-radius: 4px;
            ">
            Marcar como ENVIADO
          </button>
        </form>

        <!-- PDF -->
        <a href="{% url 'generate_pdf' order.id %}"
           target="_blank"
           style="
             margin-left: 10px;
             background-color: #0d6efd;
             color: white;
             padding: 8px 12px;
             text-decoration: none;
             border-radius: 4px;
           ">
          PDF
        </a>
      </div>
    </div>
  {% endfor %}
{% else %}
  <p>Nenhum pedido pendente no momento.</p>
{% endif %}

{% endblock %}
